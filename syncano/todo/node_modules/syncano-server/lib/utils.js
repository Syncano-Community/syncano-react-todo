'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.checkStatus = checkStatus;
exports.parseJSON = parseJSON;
exports.buildSyncanoURL = buildSyncanoURL;
exports.buildInstanceURL = buildInstanceURL;

var _settings = require('./settings');

function checkStatus(response) {
  if (response.status >= 200 && response.status < 300) {
    return response;
  }

  var error = new Error(response.statusText);

  error.response = response;

  throw error;
}

function parseJSON(response) {
  var mimetype = response.headers.get('Content-Type');

  if (response.status === 204 || mimetype === null) {
    return Promise.resolve();
  }

  // Parse JSON
  if (/^.*\/.*\+json/.test(mimetype) || /^application\/json/.test(mimetype)) {
    return response.json();
  }

  // Parse XML and plain text
  if (/^text\/.*/.test(mimetype) || /^.*\/.*\+xml/.test(mimetype) || mimetype === 'text/plain') {
    return response.text();
  }

  return response.arraybuffer();
}

function buildSyncanoURL() {
  return 'https://' + (0, _settings.getHost)() + '/' + _settings.SYNCANO_API_VERSION;
}

function buildInstanceURL(instanceName) {
  return buildSyncanoURL() + '/instances/' + instanceName;
}